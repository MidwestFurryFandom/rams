{% import 'panel_macros.html' as panel_macros %}
{% extends "preregistration/preregbase.html" %}
{% block title %}Panel Applications{% endblock %}
{% block backlink %}{% endblock %}
{% block content %}

  <script type="text/javascript">
      var showOrHidePOC = function () {
          setVisible('#point_of_contact', $.val('other_panelists'));
      };
      $(function () {
          $('<br/>').insertBefore('nobr');
          showOrHidePOC();
          $.field('other_panelists').on('change', showOrHidePOC);
      });
  </script>

  <div class="card card-body">
      <h1>{{ c.EVENT_NAME }} Panel Submission Form</h1>

      {% if c.AFTER_PANELS_DEADLINE and not c.HAS_PANELS_ADMIN_ACCESS %}
        <p>Unfortunately, the deadline for panel applications has passed and we are no longer accepting panel submissions.</p>
      {% elif c.BEFORE_PANELS_START and not c.HAS_PANELS_ADMIN_ACCESS %}
        <p>Panel applications will open {{ c.PANELS_START|datetime_local }}.</p>
      {% else %}
        {% if c.AFTER_PANELS_DEADLINE and c.HAS_PANELS_ADMIN_ACCESS %}
          <div class="alert alert-danger">
            Panel applications have closed, but because you are a logged in
            administrator you can submit a new application using this form.
          </div>
        {% elif c.BEFORE_PANELS_START and c.HAS_PANELS_ADMIN_ACCESS %}
          <div class="alert alert-danger">
            Panel applications open {{ c.PANELS_START|datetime_local }}, but because you are a logged in
            administrator you can submit a new application using this form.
          </div>
        {% endif %}
        <p>We expect many requests being sent in and will be unable to accept them
        all. We WILL be contacting potential panelists for more information as necessary.
        To increase your odds of acceptance, fill this form out accurately and keep an eye out for communication from us.
        </p>
        
        <p>Panel requests are due by {{ c.PANELS_DEADLINE|datetime_local('%-I:%M%p %Z on %A, %B %-e') }}.</p>
        
        <p>We hope to send acceptance emails out no later than {{ c.EXPECTED_RESPONSE }}.</p>
        
        <p>Contact us if there are any questions pertaining to the form at <strong>{{ c.PANELS_EMAIL|email_only|email_to_link }}</strong>.</p>
        
        <p>Good luck! We're excited to hear what you've got!</p>

        {# The action is set to "post_index" in order to bypass the NGINX cache. -#}
        <form novalidate method="post" action="post_index" role="form">
          <h2>Your Information</h2>
          <div class="card card-body pb-0 mb-3">
          {% set panelist_form = panelist_forms[0] %}
          {% include "forms/panel/panelist_form.html" %}
          </div>

          <h2>Other Panelists</h2>
          <div class="row g-sm-3 mb-3">
            <div class="col-sm-6">
            <div class="form-text">
              <label for="other_panelists">How many other panelists will be on this panel?</label>
            </div>
            <select name="other_panelists" id="other_panelists" class="form-select">
              {{ int_options(0, 4, other_panelists|length) }}
            </select>
            </div>
          </div>

          <h2>Panel Information</h2>
          <div class="card card-body pb-0 mb-3">
            <h3>Panel Details</h3>
          {% include "forms/panel/panel_info.html" %}

          <h3>Additional Information</h3>
          {% include "forms/panel/panel_other_info.html" %}
          </div>

          {% include "forms/panel/panel_consents.html" %}

          <div class="form-group">
            <div class="col-sm-6 col-sm-offset-3">
              <button type="submit" class="btn btn-primary">Submit Application</button>
            </div>
          </div>

        </form>
      {% endif %}
  </div>

{% endblock %}
