<script type="text/javascript">
    function checkStaffing(ribbons,badgeType){
        let staffing = false;
        if( badgeType === {{ c.STAFF_BADGE }} || badgeType === {{ c.CONTRACTOR_BADGE }}){
            staffing = true;
        }
        if( ribbons.includes({{  c.VOLUNTEER_RIBBON }})) {
            staffing = true;
        }
        return staffing;
    }

    function attendeeMetadata() {
        return {
            default_placeholder: {{ (not admin_area and 'register_group_member' in c.PAGE_PATH and not c.ATTENDEE_ACCOUNTS_ENABLED) | javascript_bool }},
            forbid_placeholder: {{ (not admin_area and attendee.placeholder) | javascript_bool }},
            badge_placeholder: {{ attendee.placeholder | javascript_bool }},
            badge_ribbons: {{ attendee.ribbon or [] | tojson }},
            badge_type : {{ attendee.badge_type }},
            staffing: {{ attendee.staffing | javascript_bool }},

            init() {
                staffing = checkStaffing(Alpine.raw(this.badge_ribbons), this.badge_type);
                if(this.forbid_placeholder){
                    this.badge_placeholder = false;
                } else if (this.default_placeholder) {
                    this.badge_placeholder = true;
                }
                this.$watch('badge_ribbons',
                    (ribbons) => {
                        staffing = checkStaffing(Alpine.raw(ribbons), this.badge_type);
                 });
                this.$watch('badge_type',
                    (btype) => {
                        staffing = checkStaffing(Alpine.raw(this.badge_ribbons), btype);
                })
            }
        }
    }
</script>

