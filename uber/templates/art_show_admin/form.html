{% extends "base.html" %}{% set admin_area=True %}
{% import 'forms/macros.html' as form_macros with context %}
{% block title %}Art Show Form{% endblock %}
{% block content %}

{{ macros.nav_menu(
app, c.PAGE_PATH,
"form?id={id}", "App Form", True,
"history?id={id}", "History", True,
"../reg_admin/receipt_items?id={id}", "Receipt Items", c.HAS_REG_ADMIN_ACCESS,
"index", "Return to App List", True
) }}

{% if c.AT_THE_CON and c.SPIN_TERMINAL_AUTH_KEY %}
  {% include 'registration/spin_terminal_form.html' with context %}
  <div class="row justify-content-center">
    <div id="payment-loading-message" class="alert alert-info text-center mt-3 col-8"></div>
  </div>
{% endif %}
{% if not app.is_new %}
<p><a class="btn btn-primary" href="../art_show_applications/edit?id={{ app.id }}" target="_blank">View as Attendee</a></p>
{% endif %}

<div class="card card-body">
  <h2 class="mb-3">Art Show Application{% if app.attendee %} for {{ app.attendee|form_link(true) }}{% endif %}</h2>
  <ul class="nav nav-tabs" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="app-info-tab" data-bs-toggle="tab" data-bs-target="#app-info" type="button" role="tab" aria-controls="app-info">
        <i class="fa fa-user"></i>&nbsp;{{ c.ART_SHOW_APP_TERM|title }} Info
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="pieces-tab" data-bs-toggle="tab" data-bs-target="#pieces" type="button" role="tab" aria-controls="pieces">
        <i class="fa fa-list"></i>&nbsp;Submitted Pieces
      </button>
    </li>
  </ul>
  <div class="tab-content">
      &nbsp;
    <div role="tabpanel" class="tab-pane" id="app-info" aria-labelledby="app-info-tab">
        <form method="post" id="new_agent" action="../art_show_applications/new_agent" role="form">
          <input type="hidden" name="admin" value="1" />
        </form>
        {{ form_macros.form_validation('app-form', 'validate_app') }}
        <form novalidate method="post" action="form" id="app-form" role="form">
          {% if new_app %}
          <input type="hidden" name="new_app" value="{{ new_app }}" />
          {% else %}
          <input type="hidden" name="id" value="{{ app.id }}" />
          {% endif %}
          {{ csrf_token() }}
          {% include 'forms/art_show/admin_art_show_info.html' %}
          <div class="d-flex gap-1">
              <button type="submit" name="save_return_to_search" class="btn btn-primary" value="1">Save & Return to Search</button>
              <button type="submit" name="save" class="btn btn-primary" value="1">Save</button>
          </div>
        </form>
    </div>
    <div role="tabpanel" class="tab-pane" id="pieces" aria-labelledby="pieces-tab">
        {% include 'art_show_common/art_show_pieces.html' with context %}
    </div>
  </div>
</div>
<script type="text/javascript">
  var refreshPage = function(json=null) {
    window.location.reload();
  }
</script>
{{ "js/window-hash-tabload.js"|serve_static_content }}

{% endblock %}
